from nonebot import logger, on_command
from nonebot.params import CommandArg
from nonebot.adapters.onebot.v11 import Bot, Message
from nonebot.adapters.onebot.v11.event import GroupMessageEvent

emojiMap = {
    "æƒŠè®¶": "114",
    "æ’‡å˜´": "101",
    "è‰²": "102",
    "å‘å‘†": "103",
    "å¾—æ„": "104",
    "æµæ³ª": "105",
    "å®³ç¾ž": "106",
    "é—­å˜´": "107",
    "ç¡": "108",
    "å¤§å“­": "400867",
    "å°´å°¬": "110",
    "å‘æ€’": "111",
    "è°ƒçš®": "112",
    "å‘²ç‰™": "400823",
    "å¾®ç¬‘": "100",
    "éš¾è¿‡": "115",
    "é…·": "116",
    "æŠ“ç‹‚": "118",
    "å": "119",
    "å·ç¬‘": "120",
    "å¯çˆ±": "401181",
    "ç™½çœ¼": "122",
    "å‚²æ…¢": "123",
    "é¥¥é¥¿": "124",
    "å›°": "125",
    "æƒŠæ": "126",
    "æµæ±—": "127",
    "æ†¨ç¬‘": "128",
    "æ‚ é—²": "129",
    "å¥‹æ–—": "130",
    "å’’éª‚": "131",
    "ç–‘é—®": "132",
    "å˜˜": "133",
    "æ™•": "134",
    "æŠ˜ç£¨": "135",
    "è¡°": "136",
    "éª·é«…": "137",
    "æ•²æ‰“": "138",
    "å†è§": "139",
    "å‘æŠ–": "193",
    "çˆ±æƒ…": "190",
    "è·³è·³": "192",
    "çŒªå¤´": "162",
    "æ‹¥æŠ±": "178",
    "è›‹ç³•": "168",
    "åˆ€": "171",
    "ä¾¿ä¾¿": "400643",
    "å’–å•¡": "401262",
    "çŽ«ç‘°": "400116",
    "å‡‹è°¢": "164",
    "çˆ±å¿ƒ": "400621",
    "å¿ƒç¢Ž": "167",
    "å¤ªé˜³": "176",
    "æœˆäº®": "175",
    "èµž": "179",
    "è¸©": "180",
    "æ¡æ‰‹": "181",
    "èƒœåˆ©": "182",
    "é£žå»": "400846",
    "æ€„ç«": "194",
    "è¥¿ç“œ": "400132",
    "å†·æ±—": "117",
    "æ“¦æ±—": "140",
    "æŠ é¼»": "141",
    "é¼“æŽŒ": "400420",
    "ç³—å¤§äº†": "143",
    "åç¬‘": "144",
    "å·¦å“¼å“¼": "145",
    "å³å“¼å“¼": "146",
    "å“ˆæ¬ ": "147",
    "é„™è§†": "400414",
    "å§”å±ˆ": "149",
    "å¿«å“­äº†": "150",
    "é˜´é™©": "151",
    "å·¦äº²äº²": "152",
    "å“": "153",
    "å¯æ€œ": "154",
    "èœåˆ€": "155",
    "ç¯®çƒ": "158",
    "ç¤ºçˆ±": "165",
    "æŠ±æ‹³": "183",
    "å‹¾å¼•": "184",
    "æ‹³å¤´": "400390",
    "å·®åŠ²": "186",
    "NO": "188",
    "OK": "189",
    "è½¬åœˆ": "195",
    "æŒ¥æ‰‹": "199",
    "éž­ç‚®": "121002",
    "å–å½©": "121009",
    "çˆ†ç­‹": "121011",
    "æ£’æ£’ç³–": "121012",
    "æ‰‹æžª": "400774",
    "èŒ¶": "241",
    "çœ¨çœ¼ç›": "242",
    "æ³ªå¥”": "243",
    "æ— å¥ˆ": "244",
    "å–èŒ": "245",
    "å°çº ç»“": "246",
    "å–·è¡€": "247",
    "æ–œçœ¼ç¬‘": "248",
    "doge": "249",
    "æˆ³ä¸€æˆ³": "251",
    "ç¬‘å“­": "252",
    "æˆ‘æœ€ç¾Ž": "253",
    "ç¾Šé©¼": "255",
    "å¹½çµ": "400562",
    "ç‚¹èµž": "271",
    "æ‰˜è…®": "282",
    "è„‘é˜”ç–¼": "10262",
    "æ²§æ¡‘": "10263",
    "æ‚è„¸": "10264",
    "è¾£çœ¼ç›": "10265",
    "å“¦å“Ÿ": "10266",
    "å¤´ç§ƒ": "10267",
    "é—®å·è„¸": "10268",
    "æš—ä¸­è§‚å¯Ÿ": "10269",
    "emm": "10270",
    "åƒç“œ": "10271",
    "å‘µå‘µå“’": "10272",
    "æˆ‘é…¸äº†": "10273",
    "æ±ªæ±ª": "10277",
    "æ— çœ¼ç¬‘": "10281",
    "æ•¬ç¤¼": "10282",
    "ç‹‚ç¬‘": "10283",
    "é¢æ— è¡¨æƒ…": "10284",
    "æ‘¸é±¼": "10285",
    "é­”é¬¼ç¬‘": "10286",
    "å“¦": "10287",
    "ççœ¼": "10289",
    "æ‘¸é”¦é²¤": "10293",
    "æœŸå¾…": "10294",
    "æ‹¿åˆ°çº¢åŒ…": "10295",
    "æ‹œè°¢": "10297",
    "å…ƒå®": "10298",
    "ç‰›å•Š": "10299",
    "èƒ–ä¸‰æ–¤": "10300",
    "å·¦æ‹œå¹´": "10302",
    "å³æ‹œå¹´": "10303",
    "å³äº²äº²": "10305",
    "ç‰›æ°”å†²å¤©": "10306",
    "å–µå–µ": "10307",
    "æ‰“call": "10311",
    "å˜å½¢": "10312",
    "ä»”ç»†åˆ†æž": "10314",
    "èœæ±ª": "10317",
    "å´‡æ‹œ": "10318",
    "æ¯”å¿ƒ": "10319",
    "åº†ç¥": "400198",
    "å«Œå¼ƒ": "10323",
    "åƒç³–": "10324",
    "æƒŠå“": "10325",
    "ç”Ÿæ°”": "10326",
    "ä¸¾ç‰Œç‰Œ": "10332",
    "çƒŸèŠ±": "10333",
    "è™Žè™Žç”Ÿå¨": "10334",
    "è±¹å¯Œ": "10336",
    "èŠ±æœµè„¸": "10337",
    "æˆ‘æƒ³å¼€äº†": "10338",
    "èˆ”å±": "10339",
    "æ‰“æ‹›å‘¼": "10341",
    "é…¸Q": "10342",
    "æˆ‘æ–¹äº†": "10343",
    "å¤§æ€¨ç§": "10344",
    "çº¢åŒ…å¤šå¤š": "10345",
    "ä½ çœŸæ£’æ£’": "10346",
    "å¤§å±•å®å…”": "10347",
    "åšå¼º": "10349",
    "è´´è´´": "10350",
    "æ•²æ•²": "10351",
    "å’¦": "10352",
    "æ‹œæ‰˜": "10353",
    "å°Šå˜Ÿå‡å˜Ÿ": "10354",
    "è€¶": "10355",
    "666": "10356",
    "è£‚å¼€": "10357",
    "é¾™å¹´å¿«ä¹": "10392",
    "æ–°å¹´ä¸­é¾™": "10393",
    "æ–°å¹´å¤§é¾™": "10394",
    "ç•¥ç•¥ç•¥": "10395",
    "ðŸ˜Š": "400832",
    "å˜¿å˜¿": "400832",
    "ðŸ˜Œ": "400834",
    "ç¾žæ¶©": "400834",
    "ðŸ˜š": "400848",
    "äº²äº²": "400848",
    "ðŸ˜“": "400841",
    "æ±—": "400841",
    "ðŸ˜°": "400870",
    "ç´§å¼ ": "400870",
    "ðŸ˜": "400851",
    "åèˆŒ": "400851",
    "ðŸ˜": "400823",
    "ðŸ˜œ": "400850",
    "æ·˜æ°”": "400850",
    "â˜º": "401181",
    "ðŸ˜": "400835",
    "èŠ±ç—´": "400835",
    "ðŸ˜”": "400842",
    "å¤±è½": "400842",
    "ðŸ˜„": "400826",
    "é«˜å…´": "400826",
    "ðŸ˜": "400837",
    "å“¼å“¼": "400837",
    "ðŸ˜’": "400840",
    "ä¸å±‘": "400840",
    "ðŸ˜³": "400873",
    "çžªçœ¼": "400873",
    "ðŸ˜˜": "400846",
    "ðŸ˜­": "400867",
    "ðŸ˜±": "400871",
    "å®³æ€•": "400871",
    "ðŸ˜‚": "400824",
    "æ¿€åŠ¨": "400824",
    "ðŸ’ª": "400644",
    "è‚Œè‚‰": "400644",
    "ðŸ‘Š": "400390",
    "ðŸ‘": "400408",
    "åŽ‰å®³": "400408",
    "ðŸ‘": "400420",
    "ðŸ‘Ž": "400414",
    "ðŸ™": "400396",
    "åˆå": "400396",
    "ðŸ‘Œ": "400402",
    "å¥½çš„": "400402",
    "ðŸ‘†": "400366",
    "å‘ä¸Š": "400366",
    "ðŸ‘€": "400351",
    "çœ¼ç›": "400351",
    "ðŸœ": "400151",
    "æ‹‰é¢": "400151",
    "ðŸ§": "400162",
    "åˆ¨å†°": "400162",
    "ðŸž": "400153",
    "é¢åŒ…": "400153",
    "ðŸº": "400181",
    "å•¤é…’": "400181",
    "ðŸ»": "400182",
    "å¹²æ¯": "400182",
    "â˜•": "401262",
    "ðŸŽ": "400137",
    "è‹¹æžœ": "400137",
    "ðŸ“": "400142",
    "è‰èŽ“": "400142",
    "ðŸ‰": "400132",
    "ðŸš¬": "400987",
    "å¸çƒŸ": "400987",
    "ðŸŒ¹": "400116",
    "ðŸŽ‰": "400198",
    "ðŸ’": "400631",
    "ç¤¼ç‰©": "400631",
    "ðŸ’£": "400637",
    "ç‚¸å¼¹": "400637",
    "âœ¨": "401137",
    "é—ªå…‰": "401137",
    "ðŸ’¨": "400642",
    "å¹æ°”": "400642",
    "ðŸ’¦": "400640",
    "æ°´": "400640",
    "ðŸ”¥": "400768",
    "ç«": "400768",
    "ðŸ’¤": "400638",
    "ç¡è§‰": "400638",
    "ðŸ’©": "400643",
    "ðŸ’‰": "400611",
    "æ‰“é’ˆ": "400611",
    "ðŸ“«": "400714",
    "é‚®ç®±": "400714",
    "ðŸŽ": "400302",
    "éª‘é©¬": "400302",
    "ðŸ‘§": "400459",
    "å¥³å­©": "400459",
    "ðŸ‘¦": "400453",
    "ç”·å­©": "400453",
    "ðŸµ": "400341",
    "çŒ´": "400341",
    "ðŸ·": "400343",
    "çŒª": "400343",
    "ðŸ®": "400334",
    "ç‰›": "400334",
    "ðŸ”": "400308",
    "å…¬é¸¡": "400308",
    "ðŸ¸": "400344",
    "é’è›™": "400344",
    "ðŸ‘»": "400562",
    "ðŸ›": "400315",
    "è™«": "400315",
    "ðŸ¶": "400342",
    "ç‹—": "400342",
    "ðŸ³": "400339",
    "é²¸é±¼": "400339",
    "ðŸ‘¢": "400449",
    "é´å­": "400449",
    "â˜€": "401328",
    "æ™´å¤©": "401328",
    "â”": "401145",
    "é—®å·": "401145",
    "ðŸ”«": "400774",
    "ðŸ’“": "400621",
    "ðŸª": "400281",
    "ä¾¿åˆ©åº—": "400281",
}


@on_command("e").handle()
async def _(bot: Bot, event: GroupMessageEvent, message: Message = CommandArg()):
    reply = event.reply

    if reply is None:
        return

    emojiId = None
    if len(faces := message.get("face", 1)) > 0:
        emojiId = faces[0].data.get("id")
        logger.info(f'emojiData: {faces[0].data.get("id")} {message.get("face", 1)}')
    elif len(text := message.get("text", 1)) > 0:
        try:
            emojiId = int(str(text[0]))
        except:
            emojiId = emojiMap.get(str(text[0]))

    try:
        await bot.delete_msg(message_id=event.message_id)
    except:
        logger.error(f"delete message failed {event.message_id}")

    logger.info(f"reaction: {reply.message_id} {event.message_id} {emojiId} {message.get('face', 1)}")
    if emojiId is None:
        return await bot.call_api("set_msg_emoji_like", message_id=event.message_id, emoji_id=38)

    await bot.call_api("set_msg_emoji_like", message_id=reply.message_id, emoji_id=emojiId)
